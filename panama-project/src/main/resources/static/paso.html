<style>
	#txtBusqueda, #optTipoBusqueda {
		width: 30%;
		margin-left: auto;
		margin-right: auto;
	}
	
	table{
		text-align:center;
		border:2px solid black;
		border-collapse: collapse;
		width: 50%;
		margin:auto;
	}
	
	th{
		border:2px solid black;
	}
	
	td{
		border:1px solid black;
		border-bottom:2px solid black;
	}

	.pnl_busqueda {
		height: 20%;
		text-align: center;
		padding-top: 1em;
		color: #444;
	}
	
	.modal-backdrop.fade.in {
    	display: none;
	}
	
	.modal {
    	background-color: rgba(0,0,0,0.5)!important;
	}

	.widget-title {
		height: 20%;
		text-align: center;
		padding-top: 1em;
		text-shadow: 1px 1px 2px #444;
		color: #444;
	}

	@media ( max-width : 600px) {
		#txtBusqueda {
			width: 50%;
			margin-top: 2%;
			margin-left: auto;
			margin-right: auto;
		}
		.card-view {
    		padding-left: 30%;
		}
	}

	@media ( max-width : 400px) {
		.card-view {
    		padding-left: 0%;
		}
	}
	
	@media (min-width:601px){
		.card-view {
    		padding-left: 30%;
		}
	}
	
	.no-records-found{
		display:none;
	}
	
	#closeExit {
    	margin-top: -20px;
	}
	
	#modal_edit_user .modal-dialog{
    overflow-y: initial !important
	}
	#modal_edit_user .modal-body{
	    height: 420px;
	    overflow-y: auto;
	}
	
	@media (min-width: 1000px) {
	#modal_edit_user .modal-body{
		height: 420px!important;
   	 	overflow-y: auto!important;
	}
}

@media (min-height: 800px){
#modal_edit_user .modal-body {
    height: 690px!important;
    overflow-y: auto!important;
}

.modal-header .close {
    padding: 0!important;
    margin: 0!important;
 }

</style>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
</head>


<div id="busqUsuarios" class="widget-box">
	<div class="widget-title">
		<h2 id="title_usuarios">Pasos Registrados</h2>
		<strong id="user" style="visibility: hidden"></strong>
	</div>
	<div style="text-align:center;">
		<input id="myInput" type="text" placeholder="Search.." style="align:center">
			<table>
				<thead>
					<tr>
						<th>FECHA PASO</th>
						<th>BUQUE</th>
						<th>SENTIDO</th>
						<th>COSTO</th>
						<th>ABONO</th>
						<th>DEUDA</th>
						<th>+ INFO </th>
					</tr>					
				</thead>
				<tbody id="contenido">
				</tbody>
			</table>
	</div>
	
</div>

<!--  MODAL TABLE EDIT USER -->
<div class="modal fade" id="modal_edit_user" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin-left: 0;"><span aria-hidden="true">&times;</span></button>
                <h3 class="modal-title" style=" margin-right: 35%;">Información de paso</h3>
            </div>
            <div class="modal-body form">
                <form action="#" id="form" class="form-horizontal">
                    <input type="hidden" value="" name="id"/> 
                    <div class="form-body">
                    	
                    	<div class="form-group">
                            <label class="control-label col-md-12">Número de paso</label>
                            <div class="col-md-12">
                                <input disabled name="username" placeholder="Numero de paso" class="form-control" id="input_id" type="number">
                                <span class="help-block"></span>
                            </div>
                        </div>
                       
                       <div class="form-group">
                            <label class="control-label col-md-12">Número de reserva</label>
                            <div class="col-md-12">
                                <input disabled name="username" placeholder="Numero de reserva" class="form-control" id="input_reserva" type="number">
                                <span class="help-block"></span>
                            </div>
                        </div>
                    
                   	 	<div class="form-group">
                            <label class="control-label col-md-12">Costo</label>
                            <div class="col-md-12">
                                <input disabled name="id" placeholder="Costo" class="form-control" id="input_costo" type="number">
                                <span class="help-block"></span>
                            </div>
                        </div>
              
                        <div class="form-group">
                            <label class="control-label col-md-12">Fecha de Paso</label>
                            <div class="col-md-12">
                                <input disabled name="firstName" placeholder="Fecha de Paso" class="form-control" id="input_fecha" type="date">
                                <span class="help-block"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-md-12">Total de Pasajeros</label>
                            <div class="col-md-12">
                                <input disabled name="lastName" placeholder="Pasajeros" class="form-control" id="input_pasajeros" type="text">
                                <span class="help-block"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-md-12">Esclusa a utilizar</label>
                            <div class="col-md-12">
                                <input disabled name="firstName" placeholder="Esclusa" class="form-control" id="input_esclusa" type="text">
                                <span class="help-block"></span>
                            </div>
                        </div>  
                    </div>
                </form>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-dismiss="modal" onclick="seleccionarBanco()">Pagar</button>
                <button type="button" class="btn btn-danger" data-dismiss="modal">Cancelar</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<!--  END MODAL TABLE EDIT USER -->


<!--  MODAL TABLE EDIT USER -->
<div class="modal fade" id="modal_confirm_add_reserva" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button style="margin: 0;" type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h3 style="margin-left: auto;margin-right: auto;" class="modal-title">Disponibilidad</h3>
            </div>
            <div style="text-align:center;" id="contentDisponibilidad">hay 3 cupos :D</div>
            <div class="modal-footer">
                <button type="button" onclick="" class="btn btn-primary">Guardar</button>
                <button type="button" class="btn btn-danger" data-dismiss="modal">Cancelar</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<!--  END MODAL TABLE EDIT USER -->


<script type="text/javascript">
	function obtener_pasos(idAgente){
		var pasos = [];
		var tblBody = document.getElementById("contenido");
		$.ajax({
			url: 'pasos/'+idAgente,
	        type: 'GET',
	        processData: false,
	        contentType: "application/json",
	        success:function(data){	        	
	        	if(data[0] == null){
	        		alert('No se registran pasos');
	        	}else{	        	
	        		pasos = data;
	        		var i;
	        		for (i = 0; i < pasos.length; i++) {
	        			var hilera = document.createElement("tr");
	        			
	        			var celda = document.createElement("td");
	        			var textoCelda = document.createTextNode(pasos[i].f_fecha);
	        			celda.appendChild(textoCelda);
	        			hilera.appendChild(celda);			
	        			tblBody.appendChild(hilera);
	        			
	        			celda = document.createElement("td");
	        			textoCelda = document.createTextNode(pasos[i].k_num_serie);
	        			celda.appendChild(textoCelda);
	        			hilera.appendChild(celda);			
	        			tblBody.appendChild(hilera);	        			
	        			     			
	        			celda = document.createElement("td");
	        			textoCelda = document.createTextNode(pasos[i].n_sentido);	        			
	        			celda.appendChild(textoCelda);
	        			hilera.appendChild(celda);			
	        			tblBody.appendChild(hilera);
	        			
	        			celda = document.createElement("td");
	        			textoCelda = document.createTextNode(pasos[i].v_costo);
	        			celda.appendChild(textoCelda);
	        			hilera.appendChild(celda);			
	        			tblBody.appendChild(hilera);
	        			
	        			celda = document.createElement("td");
	        			textoCelda = document.createTextNode(pasos[i].v_abono);
	        			celda.appendChild(textoCelda);
	        			hilera.appendChild(celda);			
	        			tblBody.appendChild(hilera);	
	        			
	        			celda = document.createElement("td");
	        			textoCelda = document.createTextNode(pasos[i].v_deuda);
	        			celda.appendChild(textoCelda);
	        			hilera.appendChild(celda);			
	        			tblBody.appendChild(hilera);	
	        			     			
	        			var id = pasos[i].k_id;
	        			var deuda = pasos[i].v_deuda;	
	        			var buttonnode= document.createElement('input');
	        			buttonnode.setAttribute('type','button');
	        			buttonnode.setAttribute('name','sal');
	        			buttonnode.setAttribute('value','Info');
	        			buttonnode.setAttribute('onClick', 'buscar_paso('+id+','+ deuda +')');
	        			hilera.appendChild(buttonnode);			
	        			tblBody.appendChild(hilera);
	        		
	        		}
	        	}     			
	        	
	        },
	        error:function(data){
	        	alert(data.responseText);
	        }
	    });
		
	}
	
	function buscar_paso(idReserva,deuda){
		resetFormReserva();
		
		$.ajax({
			url: 'paso/'+idReserva,
	        type: 'GET',
	        processData: false,
	        contentType: "application/json",
	        success:function(data){	        	
	        	if(idReserva == null || data.k_id == 0){
	        		alert('no existe un registro de paso con ese id...');
	        	}else{
	        		if(deuda == 0){
        				$('#btnToPay').css('visibility', 'hidden');
        			}else{
        				$('#btnToPay').css('visibility', 'visible');
        			}	        	
	        		$('#input_reserva').val(data.k_reserva);	
	         		$('#input_id').val(idReserva);
	        		$('#input_costo').val(data.v_costo);		
	        		$('#input_fecha').val(data.f_fecha);
	        		$('#input_pasajeros').val(data.q_pasajeros);
	        		$('#input_esclusa').val(data.n_esclusa);
		    		$("#modal_edit_user").modal("show");
	        	}
	        },
	        error:function(data){
	        	alert(data.responseText);
	        }
	    });
	}
	
	function resetFormReserva(){
		$('#input_reserva').val('');	
 		$('#input_id').val('');
		$('#input_costo').val('');		
		$('#input_fecha').val('');
		$('#input_pasajeros').val('');
		$('#input_esclusa').val('');
	}	
	
	$(document).ready(function() {
		loadUser();		
    });

		
	function loadUser(){				
		$.ajax({
			  type: "POST",
			  enctype: 'multipart/form-data',
			  url: 'loadUser',
			  data: {
			  	
			  },
			  success: function (data) {		  		
				  $('#user').text(data);
				  obtener_pasos(data);
			  }
			 });
	}
	
	function loadId(user){				
		$.ajax({
			url: 'agente/'+user,
			type: 'GET',
			processData: false,
			contentType: "application/json",
			success:function(data){			  			  
				if(data == 0){
	        		alert('Error al recuperar id de usuario');
	        	}else{
	        		obtener_pasos(data);
	        	}
			},
	    	error:function(data){
	    		alert(data.responseText);
	    	}	        
	 });
	}	
	function seleccioncarBanco(){				
		v_costo: $('#input_costo').val()
		$.ajax({
			
			url: 'banco/'+user,
			type: 'POST',
			processData: false,
			contentType: "application/json",
			success:function(data){			  			  
				
			},
	    	error:function(data){
	    		alert(data.responseText);
	    	}	        
	 	});
	}
</script>
<script>
	$(document).ready(function(){
	  $("#myInput").on("keyup", function() {
	    var value = $(this).val().toLowerCase();
	    $("#contenido tr").filter(function() {
	      $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
	    });
	  });
	});
</script>
