CREATE OR REPLACE FUNCTION FU_PRECIO_RESERVA(
BEAN IN NUMBER, 
LOA IN NUMBER
)
RETURN VARCHAR2 AS 
   PRECIO NUMBER(2) := 0;
   CANT_PARAMETROS NUMBER(3) := 0;
   BEAN_MIN NUMBER(5):=0;
   LOA_MIN NUMBER(5) :=0;
   BEAN_MAX NUMBER(5) :=0;
   LOA_MAX NUMBER(5) :=0;
   COSTO_ NUMBER(8,2) := 0;
BEGIN
  SELECT count(*) INTO CANT_PARAMETROS FROM PARAMETROSRESERVA;

   IF CANT_PARAMETROS>0 THEN
	FOR ID IN 1..CANT_PARAMETROS LOOP
	       
 		SELECT (SELECT Q_BEAN_MIN FROM PARAMETROSRESERVA WHERE K_ID= ID)
  		INTO BEAN_MIN 
  		FROM dual;

		SELECT (SELECT Q_BEAN_MAX FROM PARAMETROSRESERVA WHERE K_ID= ID)
  		INTO BEAN_MAX 
  		FROM dual;

		SELECT (SELECT Q_LOA_MIN FROM PARAMETROSRESERVA WHERE K_ID= ID)
  		INTO LOA_MIN 
  		FROM dual;

		SELECT (SELECT Q_LOA_MAX FROM PARAMETROSRESERVA WHERE K_ID= ID)
  		INTO LOA_MAX 
  		FROM dual;
		
		IF BEAN>=BEAN_MIN AND BEAN<=BEAN_MAX AND LOA>=LOA_MIN AND LOA<=LOA_MAX THEN
			SELECT (SELECT V_COSTO FROM PARAMETROSRESERVA WHERE K_ID= ID)
  			INTO COSTO_
  			FROM dual;
		END IF;

	END LOOP;
   END IF;
   RETURN COSTO_;
END FU_PRECIO_RESERVA;
/