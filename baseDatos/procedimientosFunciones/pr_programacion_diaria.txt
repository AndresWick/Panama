DROP FUNCTION fu_programacion_diaria;
DROP TYPE NESTED_DATOSTABLE;
DROP TYPE DATOSTABLE;

create or replace type DATOSTABLE as object (
  k_num_serie  number(8),
  f_salida date,
  n_puerto_salida varchar2 (20),
  f_llegada date,
  n_puerto_llegada varchar2 (20),
  n_esclusa varchar2(10),
  f_eta date
);
/


create or replace type NESTED_DATOSTABLE as table of DATOSTABLE;
/


CREATE OR REPLACE FUNCTION fu_programacion_diaria(lf_eta date)
	RETURN NESTED_DATOSTABLE 
	IS
		tmpVar NESTED_DATOSTABLE;
	BEGIN
		select 
		cast( multiset( 
		SELECT * FROM infopasos WHERE f_eta = lf_eta    
			) as NESTED_DATOSTABLE)
		into tmpVar
		from dual;        
RETURN tmpVar;
END;
/
